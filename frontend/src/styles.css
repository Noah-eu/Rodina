/* ============================ */
/*  Global Theme & Reset        */
/* ============================ */
:root {
  --bg: #0e1117;
  --bg-alt: #161b22;
  --panel: #1f2530;
  --panel-alt: #262f3d;
  --border: #2d3748;
  --text: #e6edf3;
  --text-dim: #9ca3af;
  --brand: #6366f1;
  --brand-accent: #818cf8;
  --ok: #10b981;
  --warn: #f59e0b;
  --danger: #ef4444;
  --radius-sm: 6px;
  --radius: 12px;
  --radius-pill: 999px;
  --shadow: 0 4px 16px -4px rgba(0,0,0,.4);
  --gradient: linear-gradient(135deg,#1f2530,#2e3850);
}

* { box-sizing: border-box; font-family: 'Inter', system-ui, Arial, sans-serif; }
html, body, #root { height: 100%; margin: 0; }
body { background: var(--bg); color: var(--text); -webkit-font-smoothing: antialiased; }

/* Scrollbars */
*::-webkit-scrollbar { width: 10px; }
*::-webkit-scrollbar-track { background: transparent; }
*::-webkit-scrollbar-thumb { background: #273444; border-radius: 6px; }
*::-webkit-scrollbar-thumb:hover { background: #32465a; }

/* Layout wrapper (mobile-first) */
.app { height: 100dvh; display: flex; flex-direction: column; max-width: 480px; margin: 0 auto; background: var(--gradient); box-shadow: 0 0 0 1px rgba(255,255,255,0.04), var(--shadow); border-radius: 0; overflow: hidden; }
@media (min-width: 900px) { .app { flex-direction: row; max-width: 1100px; border-radius: 18px; } }

/* ============================ */
/*  Sidebar                    */
/* ============================ */
.sidebar { background: var(--panel); padding: 18px 16px 18px; display: flex; flex-direction: column; gap: 14px; border-right: 1px solid var(--border); max-height: 50%; overflow-y: auto; }
@media (min-width: 900px) { .sidebar { width: 310px; max-height: none; } }
.sidebar-header { display:flex; align-items:center; justify-content: space-between; gap: 10px; }
.sidebar-header h2 { margin:0; font-size: 22px; letter-spacing: .5px; font-weight: 600; }
.settings-btn { background: var(--panel-alt); border:1px solid var(--border); color: var(--text-dim); width:42px; height:42px; display:flex; align-items:center; justify-content:center; font-size: 20px; border-radius: var(--radius); cursor:pointer; transition: background .18s, color .18s, transform .15s; }
.settings-btn:hover { background: var(--brand); color:#fff; }
.settings-btn:active { transform: scale(.94); }

.sidebar button { background: var(--brand); border:none; padding: 12px 14px; border-radius: var(--radius); cursor:pointer; color:#fff; font-weight:600; font-size:15px; box-shadow: 0 2px 6px -2px rgba(0,0,0,.5); transition: filter .2s, transform .12s; }
.sidebar button:hover { filter: brightness(1.08); }
.sidebar button:active { transform: translateY(1px); }

.sidebar ul { list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:10px; }
.sidebar li { display:flex; gap:12px; align-items:center; padding:10px 12px; background: var(--panel-alt); border:1px solid var(--border); border-radius: var(--radius); cursor:pointer; transition: background .18s, border-color .18s, transform .15s; position:relative; }
.sidebar li:hover { background: #2b3442; }
.sidebar li.selected { border-color: var(--brand); background: #2d3566; }
.sidebar li.online::after { content:''; position:absolute; width:10px; height:10px; border-radius:50%; background: var(--ok); top: 8px; right: 8px; box-shadow:0 0 0 3px #1f2530; }
.sidebar li img { width: 52px; height: 52px; border-radius: 14px; object-fit: cover; object-position:center; border:1px solid #3a4554; background:#111; }
.sidebar .name { font-weight:600; letter-spacing:.3px; }
.sidebar .last { font-size: 12px; color: var(--text-dim); margin-top:2px; }

/* ============================ */
/*  Chat Area                  */
/* ============================ */
.chat { flex:1; display:flex; flex-direction:column; background: radial-gradient(circle at 20% 20%, #233044, #161f2c 70%); position:relative; min-height:0; }
.chat-window { flex:1; display:flex; flex-direction:column; min-height:0; }
.messages { flex:1; overflow-y:auto; padding: 20px 18px 24px; display:flex; flex-direction:column; gap:18px; scroll-behavior:smooth; }
.messages::-webkit-scrollbar-thumb { background:#32465a; }

.message { display:flex; gap:14px; align-items:flex-start; line-height:1.35; }
.message.own { flex-direction: row-reverse; }
.message img { width:48px; height:48px; border-radius: 14px; object-fit: cover; box-shadow:0 4px 10px -4px rgba(0,0,0,.6); border:1px solid #3d4b5c; background:#111; }
.message > div { max-width: 68%; display:flex; flex-direction:column; gap:4px; }
@media (min-width:900px){ .message > div { max-width: 55%; } }

.msg-name { font-size: 13px; font-weight:600; color: var(--text-dim); letter-spacing:.3px; }
.message.own .msg-name { text-align:right; }
.msg-text { background: #2a3442; padding: 12px 16px 14px; border-radius: 18px; font-size:15px; position:relative; color: var(--text); word-break: break-word; hyphens:auto; box-shadow: 0 2px 6px -2px rgba(0,0,0,.6); border:1px solid #344250; }
.message.own .msg-text { background: linear-gradient(135deg,#6366f1,#818cf8); border-color:#5d63e4; color:#fff; }
.msg-time { font-size:11px; color: var(--text-dim); margin-top:2px; opacity:.85; }
.message.own .msg-time { text-align:right; }

/* Chat image bubble */
.msg-image img {
  display:block;
  width: 100%;
  max-width: min(480px, 50vw);
  height: auto;
  border-radius: 14px;
  border:1px solid #344250;
  cursor: zoom-in;
  box-shadow: 0 2px 8px -2px rgba(0,0,0,.6);
}

/* Audio message */
.msg-audio audio { width: 100%; max-width: 360px; }


/* Lightbox overlay */
.lightbox {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  padding: 24px;
}
.lightbox img {
  max-width: 95vw;
  max-height: 90vh;
  width: auto;
  height: auto;
  border-radius: 16px;
  border: 1px solid #3d4b5c;
  box-shadow: 0 10px 30px rgba(0,0,0,.6);
}
.lightbox-close {
  position: fixed;
  top: 18px;
  right: 18px;
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: var(--panel-alt);
  border: 1px solid var(--border);
  color: var(--text);
  font-size: 26px;
  line-height: 1;
  cursor: pointer;
}

/* Composer */
.send-form { display:flex; gap:10px; padding: 14px 14px calc(14px + env(safe-area-inset-bottom)); background: var(--panel); border-top:1px solid var(--border); align-items:center; box-shadow:0 -4px 14px -6px rgba(0,0,0,.5); flex-wrap:wrap; }
.send-form > div.preview-strip { order:0; flex-basis:100%; display:flex; gap:8px; overflow-x:auto; padding-bottom:4px; }
.send-form > div.preview-strip img { width:70px; height:auto; border-radius:12px; border:1px solid #344250; flex-shrink:0; }
.send-form input { flex:1; min-width:140px; background: var(--panel-alt); border:1px solid var(--border); color: var(--text); padding: 14px 16px; border-radius: 16px; font-size:15px; outline:none; transition: border-color .2s, background .2s; }
.send-form input:focus { border-color: var(--brand); background:#2b3442; }
.send-form button { background: linear-gradient(135deg,#6366f1,#818cf8); border:none; color:#fff; font-weight:600; font-size:15px; padding:14px 20px; border-radius:16px; cursor:pointer; display:flex; align-items:center; gap:6px; box-shadow:0 4px 14px -4px rgba(0,0,0,.6); transition: filter .2s, transform .18s; }
.send-form button:hover { filter:brightness(1.08); }
.send-form button:active { transform: translateY(1px); }

/* Empty state */
.chat > .empty-state { margin:auto; text-align:center; max-width:280px; opacity:.65; font-size:15px; line-height:1.5; }

/* ============================ */
/*  Auth / Forms               */
/* ============================ */
.auth { padding:34px 30px 40px; display:flex; flex-direction:column; gap:18px; background: var(--panel); border:1px solid var(--border); border-radius: 22px; width:100%; max-width:420px; margin: clamp(16px,5vh,60px) auto; box-shadow: var(--shadow); }
.auth h2 { margin:0 0 10px; font-size:26px; letter-spacing:.5px; }
.auth form { display:flex; flex-direction:column; gap:14px; }
.auth input[type="file"] { padding:0; background:transparent; border:none; }
.auth input { background: var(--panel-alt); border:1px solid var(--border); padding: 15px 16px; font-size:16px; color: var(--text); border-radius: 14px; outline:none; transition: border-color .2s, background .2s; }
.auth input:focus { border-color: var(--brand); background:#2b3442; }
.btn { --btn-bg: var(--brand); --btn-fg:#fff; background: var(--btn-bg); color: var(--btn-fg); border:none; padding: 15px 18px; border-radius: 16px; font-size:16px; font-weight:600; cursor:pointer; box-shadow:0 4px 12px -4px rgba(0,0,0,.6); transition: filter .25s, transform .18s; }
.btn.primary { --btn-bg: linear-gradient(135deg,#6366f1,#818cf8); }
.btn.secondary { --btn-bg:#334155; }
.btn.danger { --btn-bg: #dc2626; }
.btn:hover { filter:brightness(1.08); }
.btn:active { transform: translateY(1px); }
.auth p { margin:2px 0 0; font-size:14px; color: var(--text-dim); }
.auth p button { font-size:14px; padding:10px 14px; }

/* ============================ */
/*  Modal (Settings)           */
/* ============================ */
.modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,.55); backdrop-filter: blur(4px); display:flex; align-items:center; justify-content:center; z-index:1000; padding:18px; }
.modal { background: var(--panel); border:1px solid var(--border); width:100%; max-width:440px; border-radius: 24px; padding: 34px 34px 40px; display:flex; flex-direction:column; gap:26px; position:relative; box-shadow: var(--shadow); }
.modal h2 { margin:0; font-size:24px; }
.modal form { display:flex; flex-direction:column; gap:18px; }
.modal input[type="file"] { padding:0; }
.avatar-preview { width:120px; height:120px; border-radius: 26px; object-fit: cover; object-position:center; background:#111; border:2px solid #3d4b5c; box-shadow:0 4px 12px -4px rgba(0,0,0,.7); }
.close-btn { position:absolute; top:16px; right:16px; background: var(--panel-alt); border:1px solid var(--border); color: var(--text-dim); width:42px; height:42px; display:flex; align-items:center; justify-content:center; font-size:17px; border-radius: var(--radius); cursor:pointer; transition: background .2s, color .2s; }
.close-btn:hover { background: var(--brand); color:#fff; }
.feedback { font-size:14px; font-weight:600; color: var(--ok); margin:0; text-align:center; }
.feedback:empty { display:none; }

/* Utility */
.hidden { display:none !important; }
.truncate { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.text-dim { color: var(--text-dim); }

/* Animations */
@keyframes fade-in { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }
.message, .sidebar li, .auth, .modal { animation: fade-in .35s ease; }

/* Desktop adjustments */
@media (min-width: 900px) {
  .sidebar { border-right:1px solid var(--border); height:100%; }
  .chat { height:100%; }
  .messages { padding: 26px 30px 30px; }
  .send-form { padding: 20px 24px; }
  .send-form input { font-size:17px; }
  .send-form button { font-size:17px; }
}

